import{u as N,t as T,r as o,w as P,a as H,i as B,v as _,p as f,j as e,C as z,x as U,J as x,R as V,g as n,y as W,S as q,H as J}from"./index-JGGUJxTa.js";import{b as Q,i as K}from"./role-check-5Hlc5mGT.js";import{u as X,f as Y,A as Z}from"./graveyard-XASBtLuG.js";import{E as y}from"./empty-content-M6RskY8h.js";import{C as $}from"./confirm-dialog-msuNFFeT.js";import{c as ee,a as te,b as se}from"./graveyard-table-row-j4lJKb_V.js";import{D as oe}from"./DataGrid-S15przbM.js";import{G as ae,a as re}from"./GridToolbarQuickFilter-p9qYLHB8.js";import{G as g}from"./GridActionsCellItem-bFPeXFUq.js";import"./graveyard-details-carousel-RA4rwKip.js";import"./styles-_6htcQjI.js";import"./DialogTitle-GoYSdL04.js";import"./dialogTitleClasses-MNKwat2m.js";import"./DialogContent-I9aPqMht.js";import"./DialogActions-X2Ez_hXE.js";import"./index-OQBkFM31.js";import"./Autocomplete-bGY3qg-r.js";import"./Chip-8vmzDimG.js";import"./ClickAwayListener-wsQln6jz.js";import"./Checkbox-knf4fuN6.js";import"./SwitchBase-BlNstvD5.js";import"./Switch-3tzVvzRP.js";import"./Skeleton-zn8oggDq.js";import"./TablePagination-WpIltiJT.js";import"./FirstPage-bg88TicR.js";import"./TableCell-anRfX08j.js";import"./FormControlLabel-ky2qaCet.js";import"./use-light-box-BLB9u_VA.js";import"./carousel-arrow-index-QGW6sfLc.js";const le=[{value:"approved",label:"Approved"},{value:"draft",label:"Draft"}],ne={category:!1},ie=["category","actions"];function ce(){const{user:s}=N(),{t:a}=T(),[b,w]=o.useState(!1),[R,S]=o.useState(!1),{enqueueSnackbar:C}=P(),i=H(),j=B(),G=_(),{graveyards:c,graveyardsLoading:d}=X(),[m,u]=o.useState([]),[p,D]=o.useState([]),[k,A]=o.useState(ne);o.useEffect(()=>{s!=null&&s.role&&(w(Q(s==null?void 0:s.role)),S(K(s==null?void 0:s.role)))},[s==null?void 0:s.role]),o.useMemo(()=>{d||u(c)},[c,d]);const I=async t=>{try{if((await Y(t)).success){const h=m.filter(l=>l.id!==t);C("Delete success!"),u(h)}}catch(r){console.error(r)}},L=o.useCallback(()=>{console.log("delete id")},[]),M=o.useCallback(t=>{j.push(f.fellesraad.graveyard.edit(t))},[j]),F=async t=>{const r=await Z(t);if(r.searchResults.success){const h=m.map(l=>l.id===r.searchResults.result.id?{...l,approved:r.searchResults.result.approved}:l);u(h),C("Approve success!")}else console.error("Approve not success!")},E=t=>R?[e.jsx(g,{showInMenu:!0,icon:e.jsx(n,{icon:"eva:checkmark-circle-2-fill"}),label:"Approve",onClick:()=>F(t.row.id)})]:b?[e.jsx(g,{showInMenu:!0,icon:e.jsx(n,{icon:"solar:trash-bin-trash-bold"}),label:"Delete",onClick:()=>I(t.row.id)}),e.jsx(g,{showInMenu:!0,icon:e.jsx(n,{icon:"solar:pen-bold"}),label:"Edit",onClick:()=>M(t.row.id)})]:[],v=[{field:"name",headerName:a("Graveyard"),flex:1,minWidth:280,hideable:!1,renderCell:t=>e.jsx(ee,{params:t})},{field:"location",headerName:a("Location"),minWidth:280,renderCell:t=>e.jsx(te,{params:t})},{field:"publish",headerName:a("Publish"),width:110,type:"singleSelect",editable:!0,valueOptions:le,renderCell:t=>e.jsx(se,{params:t})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:t=>E(t)}],O=()=>v.filter(t=>!ie.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(z,{maxWidth:G.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(U,{heading:a("List"),links:[{name:a("Graveyard"),href:f.dashboard.root},{name:a("List")}],action:b&&e.jsx(x,{component:V,href:f.fellesraad.graveyard.create,variant:"contained",startIcon:e.jsx(n,{icon:"mingcute:add-line"}),children:a("new_graveyard")}),sx:{mb:{xs:3,md:5}}}),e.jsx(W,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:c&&e.jsx(oe,{checkboxSelection:!0,disableRowSelectionOnClick:!0,rows:m,columns:v,loading:d,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},onRowSelectionModelChange:t=>{D(t)},columnVisibilityModel:k,onColumnVisibilityModelChange:t=>A(t),slots:{toolbar:()=>e.jsxs(ae,{children:[e.jsx(re,{}),e.jsx(q,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:!!p.length&&e.jsxs(x,{size:"small",color:"error",startIcon:e.jsx(n,{icon:"solar:trash-bin-trash-bold"}),onClick:i.onTrue,children:[a("delete")," (",p.length,")"]})})]}),noRowsOverlay:()=>e.jsx(y,{title:"No Data"}),noResultsOverlay:()=>e.jsx(y,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:O}}})})]}),e.jsx($,{open:i.value,onClose:i.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",p.length," "]})," items?"]}),action:e.jsx(x,{variant:"contained",color:"error",onClick:()=>{L(),i.onFalse()},children:"Delete"})})]})}function He(){return e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx("title",{children:" Graveyard: List of the Graveyard"})}),e.jsx(ce,{})]})}export{He as default};
