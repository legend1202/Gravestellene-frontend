import{_,u as B,r as o,M as b,a as T,i as H,G as F,a1 as V,p as f,j as s,C as W,J as z,B as C,R as U,g as c,K as $,S as q,a2 as J,a3 as K,a4 as Q,H as X}from"./index-N8SydwAL.js";import{a as Y,i as Z}from"./role-check-5Hlc5mGT.js";import{E as S}from"./empty-content-Ttp3qqTd.js";import{R as ee,a as se,b as te,c as ie}from"./graveyard-table-row-w80u_KdY.js";import{D as oe}from"./DataGrid-hc9we__K.js";import{G as re,a as ae}from"./GridToolbarQuickFilter-7gGSvQkk.js";import{G as h}from"./GridActionsCellItem-YhCfvTdB.js";import"./format-number-wF8MOw5S.js";import"./index-dPzt3bTj.js";import"./Autocomplete-pOUHWdGk.js";import"./Chip-YnHBPfwg.js";import"./ClickAwayListener-cYULqw4X.js";import"./Checkbox-aend9-0B.js";import"./SwitchBase-GkPf3Zwx.js";import"./Switch--DTMlivf.js";import"./Skeleton-505Etpy4.js";import"./TablePagination-w-y8Ao-s.js";import"./FirstPage-S57-CWai.js";import"./TableCell-KZJaRtgc.js";import"./FormControlLabel-kJYRDF2M.js";const ne=[{value:"published",label:"Published"},{value:"draft",label:"Draft"}],le={category:!1},ce=["category","actions"];function de(){const{enqueueSnackbar:a}=_(),{user:t}=B(),[j,w]=o.useState(!1),[m,R]=o.useState(!1),{t:i}=b(),y=T(),x=H(),A=F(),{services:d,servicesLoading:I}=V(t==null?void 0:t.userId),[n,u]=o.useState([]),[g,D]=o.useState([]),[G,k]=o.useState(le);o.useEffect(()=>{t!=null&&t.role&&(w(Y(t==null?void 0:t.role)),R(Z(t==null?void 0:t.role)))},[t==null?void 0:t.role]);const L=o.useCallback(e=>{x.push(f.fellesraad.service.edit(e))},[x]),M=async()=>{const e=await J();u(e.searchResults.result)};o.useEffect(()=>{m?M():d&&d.length>0&&u(d)},[m,d]);const E=async e=>{try{if((await K(e)).success){const p=n.filter(l=>l.id!==e);u(p),a("Delete success!")}}catch(r){console.error(r)}},N=async e=>{const r=await Q(e);if(r.searchResults.success){const p=n.map(l=>l.id===r.searchResults.result.id?{...l,approved:r.searchResults.result.approved}:l);u(p),a("Approve success!")}else console.error("Approve not success!")},O=e=>m?[s.jsx(h,{showInMenu:!0,icon:s.jsx(c,{icon:"eva:checkmark-circle-2-fill"}),label:"Approve",onClick:()=>N(e.row.id)})]:j?[s.jsx(h,{showInMenu:!0,icon:s.jsx(c,{icon:"solar:trash-bin-trash-bold"}),label:i("delete"),onClick:()=>E(e.row.id)}),s.jsx(h,{showInMenu:!0,icon:s.jsx(c,{icon:"solar:pen-bold"}),label:i("Edit"),onClick:()=>L(e.row.id)})]:[],v=[{field:"name",headerName:i("service_name"),flex:1,minWidth:100,hideable:!1,renderCell:e=>s.jsx(ee,{params:e})},{field:"description",headerName:i("Description"),minWidth:280,renderCell:e=>s.jsx(se,{params:e})},{field:"price",headerName:i("Price"),minWidth:280,renderCell:e=>s.jsx(te,{params:e})},{field:"Approve",headerName:i("Approve"),width:110,type:"singleSelect",editable:!0,valueOptions:ne,renderCell:e=>s.jsx(ie,{params:e})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:e=>O(e)}],P=()=>v.filter(e=>!ce.includes(e.field)).map(e=>e.field);return s.jsxs(W,{maxWidth:A.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[s.jsx(z,{heading:i("List"),links:[{name:i("service"),href:f.fellesraad.service.root},{name:i("List")}],action:s.jsx(C,{component:U,href:f.fellesraad.service.create,variant:"contained",startIcon:s.jsx(c,{icon:"mingcute:add-line"}),children:i("new_service")}),sx:{mb:{xs:3,md:5}}}),s.jsx($,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"},px:3},children:n&&n.length>0&&s.jsx(oe,{disableRowSelectionOnClick:!0,rows:n,columns:v,loading:I,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},onRowSelectionModelChange:e=>{D(e)},columnVisibilityModel:G,onColumnVisibilityModelChange:e=>k(e),slots:{toolbar:()=>s.jsxs(re,{children:[s.jsx(ae,{}),s.jsx(q,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:!!g.length&&s.jsxs(C,{size:"small",color:"error",startIcon:s.jsx(c,{icon:"solar:trash-bin-trash-bold"}),onClick:y.onTrue,children:["Delete (",g.length,")"]})})]}),noRowsOverlay:()=>s.jsx(S,{title:"No Data"}),noResultsOverlay:()=>s.jsx(S,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:P}}})})]})}function Le(){const{t:a}=b();return s.jsxs(s.Fragment,{children:[s.jsx(X,{children:s.jsxs("title",{children:[" ",`${a("services")}: ${a("list_of_services")}`]})}),s.jsx(de,{})]})}export{Le as default};
