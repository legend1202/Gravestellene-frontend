import{_ as z,r as p,i as B,M as O,c as K,b as r,bA as J,d as Q,o as W,p as X,j as s,N as f,K as L,aj as q,S as g,e as b,T as F,v as Y,h as Z,F as u,A as P}from"./index-CunmLLou.js";import{c as ee,d as se,e as ae}from"./graveyard-13Iwe1yh.js";import{R as ie}from"./rhf-upload-ZVtlznMv.js";import{R as le}from"./rhf-editor-SJtSrAmV.js";function xe({currentProduct:e}){const{enqueueSnackbar:w}=z(),[k,v]=p.useState(""),S=B(),[n,h]=p.useState([]),{t:l}=O(),C=K().shape({name:r().required("Name is required"),location:r().required("Location is required"),picture:J().min(1,"Images is required"),content:r().required("Content is required"),newsLink:r().required("News is required"),forecastLink:r().required("Forecast is required")}),y=p.useMemo(()=>({name:(e==null?void 0:e.name)||"",location:(e==null?void 0:e.location)||"",picture:(e==null?void 0:e.picture)||[],content:(e==null?void 0:e.content)||"",newsLink:(e==null?void 0:e.newsLink)||"",forecastLink:(e==null?void 0:e.forecastLink)||""}),[e]),R=Q({resolver:W(C),defaultValues:y}),{reset:d,watch:G,setValue:m,handleSubmit:U,formState:{isSubmitting:E}}=R,t=G();p.useEffect(()=>{e&&(h(e.picture),d(y))},[e,y,d]);const N=U(async x=>{var c,o;try{if(e){const i={...e,...t,picture:n},a=await ee(i);(c=a.searchResults)!=null&&c.success?(d(),w("Update success!")):v(a==null?void 0:a.message)}else{const i={...t,picture:n},a=await se(i);(o=a.searchResults)!=null&&o.success?(d(),w("Create success!")):v(a==null?void 0:a.message)}S.push(X.fellesraad.graveyard.list)}catch(i){v(i==null?void 0:i.message),console.error(i)}}),A=p.useCallback(async x=>{const c=t.picture||[],o=x.map(j=>Object.assign(j,{preview:URL.createObjectURL(j)})),i=await ae(x),a=[...n,i];e!=null&&e.picture?h([...e.picture,...a]):h([...a]),m("picture",[...c,...o],{shouldValidate:!0})},[m,t.picture,n,e==null?void 0:e.picture]),D=p.useCallback(x=>{var o,i;const c=t.picture&&((o=t.picture)==null?void 0:o.filter(a=>a!==x));(i=t.picture)==null||i.forEach((a,j)=>{if(a===x){const V=n==null?void 0:n.filter((ne,$)=>j!==$);h(V)}}),m("picture",c)},[m,t.picture,n]),_=p.useCallback(()=>{m("picture",[]),h([])},[m]),T=async()=>{console.log("")},H=s.jsx(f,{xs:12,md:12,children:s.jsxs(L,{children:[s.jsx(q,{title:l("Details")}),s.jsxs(g,{spacing:3,sx:{p:3},children:[s.jsx(b,{name:"name",label:l("Graveyard_Name")}),s.jsx(b,{name:"location",label:l("Graveyard_Location")}),s.jsxs(g,{spacing:1.5,children:[s.jsx(F,{variant:"subtitle2",children:l("Content")}),s.jsx(le,{simple:!0,name:"content"})]}),s.jsxs(g,{spacing:1.5,children:[s.jsx(F,{variant:"subtitle2",children:l("Pictures")}),s.jsx(ie,{multiple:!0,thumbnail:!0,name:"picture",maxSize:13145728,onDrop:A,onRemove:D,onRemoveAll:_,onUpload:T})]})]})]})}),M=s.jsx(f,{xs:12,md:12,children:s.jsxs(L,{children:[s.jsx(q,{title:l("Properties")}),s.jsx(g,{spacing:3,sx:{p:3},children:s.jsxs(Y,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(1, 1fr)"},children:[s.jsx(b,{name:"newsLink",label:l("News")}),s.jsx(b,{name:"forecastLink",label:l("Forecast")})]})})]})}),I=s.jsx(f,{xs:12,md:12,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:s.jsx(Z,{type:"submit",variant:"contained",size:"large",loading:E,children:l(e?"save_changes":"create_product")})});return s.jsx(u,{methods:R,onSubmit:N,children:s.jsxs(f,{container:!0,spacing:3,children:[!!k&&s.jsx(P,{severity:"error",sx:{mb:3},children:k}),H,M,I]})})}export{xe as G};
