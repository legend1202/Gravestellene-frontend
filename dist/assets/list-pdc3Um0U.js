import{j as e,E as P,t as w,k as C,S as A,v as B,B as H,p as i,u as z,r as s,y as U,b as W,x as _,C as V,z as q,J as h,R as J,h as n,D as Q,H as $}from"./index-Ai7WBed9.js";import{d as K,e as X,A as Y}from"./graveyard-I0sPvOSg.js";import{E as j}from"./empty-content-UxxF0rT4.js";import{C as Z}from"./confirm-dialog-JFusP8M8.js";import{D as ee,G as te,a as oe,b as f}from"./DataGrid-t_zOT0XT.js";import"./graveyard-details-carousel-WPbnfTg6.js";import"./styles-fFnF4M8b.js";import"./DialogTitle-uRTUuviV.js";import"./dialogTitleClasses-uJ_3k2aX.js";import"./DialogContent-pxZFvYQ6.js";import"./DialogActions-h-2z-LTc.js";import"./index-aEol1cJN.js";import"./Autocomplete-JEHmlUt8.js";import"./Chip-ZcR-KSZs.js";import"./ClickAwayListener-SabWFJsc.js";import"./Checkbox-te7qU-XE.js";import"./SwitchBase-aDzKqP7k.js";import"./Switch-NjMVebH_.js";import"./Skeleton-VEDJMMU1.js";import"./TablePagination-Jkpqhja2.js";import"./FirstPage-05ItheTm.js";import"./TableCell-LO4OfV7U.js";import"./FormControlLabel-T6TgLX-i.js";import"./use-light-box-BBXNMXVG.js";import"./carousel-arrow-index-QaIkDpES.js";function re(t){let r=!1;return t==="ADMIN"&&(r=!0),r}function se(t){let r=!1;return t==="FELLESAAD"&&(r=!0),r}function ne({params:t}){return e.jsx(P,{variant:"soft",color:t.row.approved&&"info"||"default",children:t.row.approved?"Approved":"Draft"})}function ae({params:t}){return e.jsx(w,{primary:t.row.location,secondary:t.row.location,primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}function ie({params:t}){const r=C(),l=c=>{r.push(i.fellesraad.graveyard.details(c))};return e.jsxs(A,{direction:"row",alignItems:"center",sx:{py:2,width:1},children:[e.jsx(B,{alt:t.row.name,src:t.row.coverUrl,variant:"rounded",sx:{width:64,height:64,mr:2}}),e.jsx(w,{disableTypography:!0,onClick:()=>l(`${t==null?void 0:t.id}`),secondary:e.jsx(H,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:t.row.name}),sx:{display:"flex",flexDirection:"column",cursor:"pointer"}})]})}const le=[{value:"approved",label:"Approved"},{value:"draft",label:"Draft"}],ce={category:!1},de=["category","actions"];function ue(){const{user:t}=z(),[r,l]=s.useState(!1),[c,S]=s.useState(!1),{enqueueSnackbar:x}=U(),a=W(),y=C(),D=_(),{graveyards:d,graveyardsLoading:u}=K(),[g,b]=s.useState([]),[p,G]=s.useState([]),[R,k]=s.useState(ce);s.useEffect(()=>{t!=null&&t.role&&(l(se(t==null?void 0:t.role)),S(re(t==null?void 0:t.role)))},[t==null?void 0:t.role]),s.useMemo(()=>{u||b(d)},[d,u]);const I=async o=>{try{if((await X(o)).success){const T=g.filter(O=>O.id!==o);x("Delete success!"),b(T)}}catch(m){console.error(m)}},L=s.useCallback(()=>{console.log("delete id")},[]),E=s.useCallback(o=>{y.push(i.fellesraad.graveyard.edit(o))},[y]),M=async o=>{(await Y(o)).searchResults.success?x("Approve success!"):console.error("Approve not success!")},F=o=>c?[e.jsx(f,{showInMenu:!0,icon:e.jsx(n,{icon:"eva:checkmark-circle-2-fill"}),label:"Approve",onClick:()=>M(o.row.id)})]:r?[e.jsx(f,{showInMenu:!0,icon:e.jsx(n,{icon:"solar:trash-bin-trash-bold"}),label:"Delete",onClick:()=>I(o.row.id)}),e.jsx(f,{showInMenu:!0,icon:e.jsx(n,{icon:"solar:pen-bold"}),label:"Edit",onClick:()=>E(o.row.id)})]:[],v=[{field:"name",headerName:"Graveyard",flex:1,minWidth:280,hideable:!1,renderCell:o=>e.jsx(ie,{params:o})},{field:"location",headerName:"location",minWidth:280,renderCell:o=>e.jsx(ae,{params:o})},{field:"publish",headerName:"Publish",width:110,type:"singleSelect",editable:!0,valueOptions:le,renderCell:o=>e.jsx(ne,{params:o})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:o=>F(o)}],N=()=>v.filter(o=>!de.includes(o.field)).map(o=>o.field);return e.jsxs(e.Fragment,{children:[e.jsxs(V,{maxWidth:D.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(q,{heading:"List",links:[{name:"Graveyard",href:i.dashboard.root},{name:"List"}],action:r&&e.jsx(h,{component:J,href:i.fellesraad.graveyard.create,variant:"contained",startIcon:e.jsx(n,{icon:"mingcute:add-line"}),children:"New Graveyard"}),sx:{mb:{xs:3,md:5}}}),e.jsx(Q,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:d&&e.jsx(ee,{checkboxSelection:!0,disableRowSelectionOnClick:!0,rows:g,columns:v,loading:u,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},onRowSelectionModelChange:o=>{G(o)},columnVisibilityModel:R,onColumnVisibilityModelChange:o=>k(o),slots:{toolbar:()=>e.jsxs(te,{children:[e.jsx(oe,{}),e.jsx(A,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:!!p.length&&e.jsxs(h,{size:"small",color:"error",startIcon:e.jsx(n,{icon:"solar:trash-bin-trash-bold"}),onClick:a.onTrue,children:["Delete (",p.length,")"]})})]}),noRowsOverlay:()=>e.jsx(j,{title:"No Data"}),noResultsOverlay:()=>e.jsx(j,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:N}}})})]}),e.jsx(Z,{open:a.value,onClose:a.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete"," ",e.jsxs("strong",{children:[" ",p.length," "]})," items?"]}),action:e.jsx(h,{variant:"contained",color:"error",onClick:()=>{L(),a.onFalse()},children:"Delete"})})]})}function Oe(){return e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsx("title",{children:" Graveyard: List of the Graveyard"})}),e.jsx(ue,{})]})}export{Oe as default};
