import{a as T,u as O,r,Z as B,b as H,k as W,G as P,p as f,j as e,C as _,J as z,B as x,R as V,h as i,K as U,S as q,H as J}from"./index-F58UWM6d.js";import{b as K,i as Q}from"./role-check-5Hlc5mGT.js";import{b as Z,f as X,A as Y}from"./graveyard-fuRNBAw2.js";import{E as v}from"./empty-content-cu3d-hY6.js";import{C as $}from"./confirm-dialog-Eyd0MEzy.js";import{c as ee,a as te,b as oe}from"./graveyard-table-row-HasR15m2.js";import{D as se}from"./DataGrid-Qd0gu4hV.js";import{G as re,a as ae}from"./GridToolbarQuickFilter-cyoWmbS9.js";import{G as g}from"./GridActionsCellItem-ZjyDAvNv.js";import"./graveyard-details-carousel-6xxjTjMo.js";import"./styles-ChwulusQ.js";import"./DialogTitle-Yv6DKYq6.js";import"./dialogTitleClasses-fTeeAY48.js";import"./DialogContent-sEfmhfdt.js";import"./DialogActions-qDclrG3N.js";import"./index-AQ_QNN8Z.js";import"./Autocomplete--E0PVWeu.js";import"./Chip-Bf9OfEDF.js";import"./ClickAwayListener-FZVsDqfR.js";import"./Checkbox-LoW-zYTz.js";import"./SwitchBase-QO7WNYjK.js";import"./Switch-mI38wMsz.js";import"./Skeleton-UqJgurFx.js";import"./TablePagination-boMs0Lib.js";import"./KeyboardArrowRight-nt3KTS5I.js";import"./FirstPage-LKd4WdE0.js";import"./TableCell-6a7cWiGU.js";import"./FormControlLabel-yEUOmb-6.js";import"./use-light-box-foBx3VHE.js";import"./carousel-arrow-index-qUGojmK7.js";const ne={category:!1},ie=["category","actions"];function le(){const{user:o}=T(),{t:s}=O(),[b,w]=r.useState(!1),[R,G]=r.useState(!1),{enqueueSnackbar:C}=B(),l=H(),j=W(),S=P(),{graveyards:c,graveyardsLoading:d}=Z(),[m,u]=r.useState([]),[p,k]=r.useState([]),[A,D]=r.useState(ne);r.useEffect(()=>{o!=null&&o.role&&(w(K(o==null?void 0:o.role)),G(Q(o==null?void 0:o.role)))},[o==null?void 0:o.role]),r.useMemo(()=>{d||u(c)},[c,d]);const M=async t=>{try{if((await X(t)).success){const h=m.filter(n=>n.id!==t);C("Delete success!"),u(h)}}catch(a){console.error(a)}},I=r.useCallback(()=>{console.log("delete id")},[]),L=r.useCallback(t=>{j.push(f.fellesraad.graveyard.edit(t))},[j]),F=async t=>{const a=await Y(t);if(a.searchResults.success){const h=m.map(n=>n.id===a.searchResults.result.id?{...n,approved:a.searchResults.result.approved}:n);u(h),C("Approve success!")}else console.error("Approve not success!")},E=t=>R?[e.jsx(g,{showInMenu:!0,icon:e.jsx(i,{icon:"eva:checkmark-circle-2-fill"}),label:s("Approve"),onClick:()=>F(t.row.id)})]:b?[e.jsx(g,{showInMenu:!0,icon:e.jsx(i,{icon:"solar:trash-bin-trash-bold"}),label:s("delete"),onClick:()=>M(t.row.id)}),e.jsx(g,{showInMenu:!0,icon:e.jsx(i,{icon:"solar:pen-bold"}),label:s("Edit"),onClick:()=>L(t.row.name)})]:[],y=[{field:"name",headerName:s("Graveyard"),flex:1,minWidth:280,hideable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(ee,{params:t})},{field:"location",headerName:s("Location"),minWidth:280,disableColumnMenu:!0,renderCell:t=>e.jsx(te,{params:t})},{field:"publish",headerName:s("Approve"),minWidth:110,disableColumnMenu:!0,renderCell:t=>e.jsx(oe,{params:t})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",minWidth:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:t=>E(t)}],N=()=>y.filter(t=>!ie.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(_,{maxWidth:S.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(z,{heading:s("List"),links:[{name:s("Graveyard"),href:f.dashboard.root},{name:s("List")}],action:b&&e.jsx(x,{component:V,href:f.fellesraad.graveyard.create,variant:"contained",startIcon:e.jsx(i,{icon:"mingcute:add-line"}),children:s("new_graveyard")}),sx:{mb:{xs:3,md:5}}}),e.jsx(U,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:c&&e.jsx(se,{checkboxSelection:!0,disableRowSelectionOnClick:!0,rows:m,columns:y,loading:d,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},onRowSelectionModelChange:t=>{k(t)},columnVisibilityModel:A,onColumnVisibilityModelChange:t=>D(t),slots:{toolbar:()=>e.jsxs(re,{children:[e.jsx(ae,{}),e.jsx(q,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:!!p.length&&e.jsxs(x,{size:"small",color:"error",startIcon:e.jsx(i,{icon:"solar:trash-bin-trash-bold"}),onClick:l.onTrue,children:[s("delete")," (",p.length,")"]})})]}),noRowsOverlay:()=>e.jsx(v,{title:"No Data"}),noResultsOverlay:()=>e.jsx(v,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:N}}})})]}),e.jsx($,{open:l.value,onClose:l.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",p.length," "]})," items?"]}),action:e.jsx(x,{variant:"contained",color:"error",onClick:()=>{I(),l.onFalse()},children:"Delete"})})]})}function He(){return e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx("title",{children:" Graveyard: List of the Graveyard"})}),e.jsx(le,{})]})}export{He as default};
