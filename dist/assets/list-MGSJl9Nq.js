import{u as T,M as O,r as o,_ as B,a as H,i as P,G as W,p as f,j as e,C as _,J as z,B as x,R as V,g as i,K as U,S as q,H as J}from"./index-CunmLLou.js";import{b as K,i as Q}from"./role-check-5Hlc5mGT.js";import{b as X,f as Y,A as Z}from"./graveyard-13Iwe1yh.js";import{E as w}from"./empty-content-NdHJ5ZV0.js";import{C as $}from"./confirm-dialog-eLtbkqWE.js";import{c as ee,a as te,b as se}from"./graveyard-table-row-MZQRW00P.js";import{D as oe}from"./DataGrid-RTr-U8F3.js";import{G as re,a as ae}from"./GridToolbarQuickFilter-bp48NLEh.js";import{G as g}from"./GridActionsCellItem-Nemqnii8.js";import"./graveyard-details-carousel-6iAS3lrI.js";import"./styles-7oBl_VkY.js";import"./DialogTitle-GOOymP4W.js";import"./dialogTitleClasses-2MPpGYRa.js";import"./DialogContent-B-VvmhNR.js";import"./DialogActions-5ckigJHQ.js";import"./index-jGaRA_M3.js";import"./Autocomplete-s1YegUFl.js";import"./Chip-BVGf60xL.js";import"./ClickAwayListener-4HsEc99k.js";import"./Checkbox-oddwhIQJ.js";import"./SwitchBase-hAFlUYrk.js";import"./Switch-bFYH9Y2J.js";import"./Skeleton-SbcBrwyf.js";import"./TablePagination-v6AtQ65M.js";import"./FirstPage-jMewCZH7.js";import"./TableCell-Gj9JH0iU.js";import"./FormControlLabel-L6vUYbWe.js";import"./use-light-box-P2i4GV7G.js";import"./carousel-arrow-index-JFfLOLFN.js";const ne={category:!1},ie=["category","actions"];function le(){const{user:s}=T(),{t:r}=O(),[b,v]=o.useState(!1),[R,G]=o.useState(!1),{enqueueSnackbar:C}=B(),l=H(),j=P(),S=W(),{graveyards:c,graveyardsLoading:d}=X(),[m,u]=o.useState([]),[p,k]=o.useState([]),[D,A]=o.useState(ne);o.useEffect(()=>{s!=null&&s.role&&(v(K(s==null?void 0:s.role)),G(Q(s==null?void 0:s.role)))},[s==null?void 0:s.role]),o.useMemo(()=>{d||u(c)},[c,d]);const M=async t=>{try{if((await Y(t)).success){const h=m.filter(n=>n.id!==t);C("Delete success!"),u(h)}}catch(a){console.error(a)}},I=o.useCallback(()=>{console.log("delete id")},[]),L=o.useCallback(t=>{j.push(f.fellesraad.graveyard.edit(t))},[j]),F=async t=>{const a=await Z(t);if(a.searchResults.success){const h=m.map(n=>n.id===a.searchResults.result.id?{...n,approved:a.searchResults.result.approved}:n);u(h),C("Approve success!")}else console.error("Approve not success!")},E=t=>R?[e.jsx(g,{showInMenu:!0,icon:e.jsx(i,{icon:"eva:checkmark-circle-2-fill"}),label:"Approve",onClick:()=>F(t.row.id)})]:b?[e.jsx(g,{showInMenu:!0,icon:e.jsx(i,{icon:"solar:trash-bin-trash-bold"}),label:"Delete",onClick:()=>M(t.row.id)}),e.jsx(g,{showInMenu:!0,icon:e.jsx(i,{icon:"solar:pen-bold"}),label:"Edit",onClick:()=>L(t.row.name)})]:[],y=[{field:"name",headerName:r("Graveyard"),flex:1,minWidth:280,hideable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(ee,{params:t})},{field:"location",headerName:r("Location"),minWidth:280,disableColumnMenu:!0,renderCell:t=>e.jsx(te,{params:t})},{field:"publish",headerName:r("Publish"),minWidth:110,disableColumnMenu:!0,renderCell:t=>e.jsx(se,{params:t})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",minWidth:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:t=>E(t)}],N=()=>y.filter(t=>!ie.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(_,{maxWidth:S.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(z,{heading:r("List"),links:[{name:r("Graveyard"),href:f.dashboard.root},{name:r("List")}],action:b&&e.jsx(x,{component:V,href:f.fellesraad.graveyard.create,variant:"contained",startIcon:e.jsx(i,{icon:"mingcute:add-line"}),children:r("new_graveyard")}),sx:{mb:{xs:3,md:5}}}),e.jsx(U,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:c&&e.jsx(oe,{checkboxSelection:!0,disableRowSelectionOnClick:!0,rows:m,columns:y,loading:d,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},onRowSelectionModelChange:t=>{k(t)},columnVisibilityModel:D,onColumnVisibilityModelChange:t=>A(t),slots:{toolbar:()=>e.jsxs(re,{children:[e.jsx(ae,{}),e.jsx(q,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:!!p.length&&e.jsxs(x,{size:"small",color:"error",startIcon:e.jsx(i,{icon:"solar:trash-bin-trash-bold"}),onClick:l.onTrue,children:[r("delete")," (",p.length,")"]})})]}),noRowsOverlay:()=>e.jsx(w,{title:"No Data"}),noResultsOverlay:()=>e.jsx(w,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:N}}})})]}),e.jsx($,{open:l.value,onClose:l.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",p.length," "]})," items?"]}),action:e.jsx(x,{variant:"contained",color:"error",onClick:()=>{I(),l.onFalse()},children:"Delete"})})]})}function Be(){return e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx("title",{children:" Graveyard: List of the Graveyard"})}),e.jsx(le,{})]})}export{Be as default};
