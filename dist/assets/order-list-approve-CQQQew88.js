import{j as e,X as l,v as p,u as A,x as M,S as x,a as O,r as n,Z as G,G as N,$ as i,C as L,J as R,p as T,K as E,h as k}from"./index-HKvYvq3j.js";import{i as I}from"./role-check-5Hlc5mGT.js";import{G as W,A as P}from"./order-ZPZ1Bd4u.js";import{E as f}from"./empty-content-ikLVFtYm.js";import{f as B}from"./format-number-atgkyq5m.js";import{D as H}from"./DataGrid-DpAWUB_n.js";import{G as U}from"./GridActionsCellItem-LEzex8T7.js";function V({params:r}){return e.jsx(e.Fragment,{children:r.row.serviceDetails.map(s=>e.jsx(l,{disableTypography:!0,primary:e.jsx(p,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:B(s.price)}),sx:{display:"flex",flexDirection:"column"}},s.id))})}function _({params:r}){const{t:s}=A();return e.jsx(M,{variant:"soft",color:r.row.approved&&"info"||"default",children:r.row.approved?s("Approved"):s("Draft")})}function $({params:r}){return e.jsx(l,{primary:`${r.row.gravestoneDetails.firstName} ${r.row.gravestoneDetails.lastName}`,primaryTypographyProps:{typography:"body2",noWrap:!0}})}function z({params:r}){return e.jsx(x,{direction:"row",alignItems:"center",sx:{py:2,width:1},children:r.row.serviceDetails.map(s=>e.jsx(l,{disableTypography:!0,primary:e.jsx(p,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:s.name}),sx:{display:"flex",flexDirection:"column"}},s.id))})}function F({params:r}){return e.jsx(x,{direction:"row",alignItems:"center",sx:{py:2,width:1},children:e.jsx(l,{disableTypography:!0,primary:e.jsx(p,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:r.row.userDetails.name})})})}const q={category:!1},J=["category","actions"];function re(){const{user:r}=O(),[s,h]=n.useState(!1),{enqueueSnackbar:y}=G(),g=N(),{orders:o,ordersLoading:b}=W(),[u,d]=n.useState([]),[C,v]=n.useState(q);n.useEffect(()=>{r!=null&&r.role&&h(I(r==null?void 0:r.role))},[r==null?void 0:r.role]),n.useEffect(()=>{if(o&&o.length>0)if(s)d(o);else{const t=o.filter(a=>(a==null?void 0:a.approved)===!0);d(t)}},[o,s]);const j=async t=>{const a=await P(t);if(a.results.success){const S=u.map(c=>c.id===a.results.result.id?{...c,approved:a.results.result.approved}:c);d(S),y("Approve success!")}else console.error("Approve not success!")},w=t=>s?[e.jsx(U,{showInMenu:!0,icon:e.jsx(k,{icon:"eva:checkmark-circle-2-fill"}),label:i("Approve"),onClick:()=>j(t.row.id)})]:[],m=[{field:"name",headerName:i("Client"),flex:1,minWidth:140,hideable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(F,{params:t})},{field:"orders",headerName:i("Orders"),minWidth:140,disableColumnMenu:!0,renderCell:t=>e.jsx(z,{params:t})},{field:"price",headerName:i("Price"),minWidth:140,disableColumnMenu:!0,renderCell:t=>e.jsx(V,{params:t})},{field:"gravestone",headerName:i("Gravestone"),minWidth:280,type:"singleSelect",disableColumnMenu:!0,renderCell:t=>e.jsx($,{params:t})},{field:"approve",headerName:i("Approve"),minWidth:110,type:"singleSelect",disableColumnMenu:!0,renderCell:t=>e.jsx(_,{params:t})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:t=>w(t)}],D=()=>m.filter(t=>!J.includes(t.field)).map(t=>t.field);return e.jsxs(L,{maxWidth:g.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(R,{heading:i("List"),links:[{name:i("Order"),href:T.dashboard.root},{name:i("List")}],sx:{mb:{xs:3,md:5}}}),e.jsx(E,{sx:{height:{xs:800,md:2},px:3,flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:o&&e.jsx(H,{disableRowSelectionOnClick:!0,rows:u,columns:m,loading:b,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},columnVisibilityModel:C,onColumnVisibilityModelChange:t=>v(t),slots:{noRowsOverlay:()=>e.jsx(f,{title:"No Data"}),noResultsOverlay:()=>e.jsx(f,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:D}}})})]})}export{re as O};
