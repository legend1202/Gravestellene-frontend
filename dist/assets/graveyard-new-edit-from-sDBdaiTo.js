import{w as $,r as p,i as z,t as O,c as X,b as d,dY as Y,d as J,o as K,p as Q,j as s,_ as j,y as L,X as q,S as g,e as b,T as F,B as W,h as Z,F as u,A as P}from"./index-JGGUJxTa.js";import{c as ee,d as se,e as ae}from"./graveyard-XASBtLuG.js";import{R as ie}from"./rhf-upload-MHdRz4aB.js";import{R as le}from"./rhf-editor-ej_Ctkh8.js";function xe({currentProduct:e}){const{enqueueSnackbar:w}=$(),[k,v]=p.useState(""),S=z(),[n,h]=p.useState([]),{t:l}=O(),C=X().shape({name:d().required("Name is required"),location:d().required("Location is required"),picture:Y().min(1,"Images is required"),content:d().required("Content is required"),newsLink:d().required("News is required"),forecastLink:d().required("Forecast is required")}),y=p.useMemo(()=>({name:(e==null?void 0:e.name)||"",location:(e==null?void 0:e.location)||"",picture:(e==null?void 0:e.picture)||[],content:(e==null?void 0:e.content)||"",newsLink:(e==null?void 0:e.newsLink)||"",forecastLink:(e==null?void 0:e.forecastLink)||""}),[e]),R=J({resolver:K(C),defaultValues:y}),{reset:r,watch:G,setValue:m,handleSubmit:U,formState:{isSubmitting:E}}=R,t=G();p.useEffect(()=>{e&&(h(e.picture),r(y))},[e,y,r]);const D=U(async x=>{var c,o;try{if(e){const i={...e,...t,picture:n},a=await ee(i);(c=a.searchResults)!=null&&c.success?(r(),w("Update success!")):v(a==null?void 0:a.message)}else{const i={...t,picture:n},a=await se(i);(o=a.searchResults)!=null&&o.success?(r(),w("Create success!")):v(a==null?void 0:a.message)}S.push(Q.fellesraad.graveyard.list)}catch(i){v(i==null?void 0:i.message),console.error(i)}}),N=p.useCallback(async x=>{const c=t.picture||[],o=x.map(f=>Object.assign(f,{preview:URL.createObjectURL(f)})),i=await ae(x),a=[...n,i];e!=null&&e.picture?h([...e.picture,...a]):h([...a]),m("picture",[...c,...o],{shouldValidate:!0})},[m,t.picture,n,e==null?void 0:e.picture]),_=p.useCallback(x=>{var o,i;const c=t.picture&&((o=t.picture)==null?void 0:o.filter(a=>a!==x));(i=t.picture)==null||i.forEach((a,f)=>{if(a===x){const M=n==null?void 0:n.filter((ne,V)=>f!==V);h(M)}}),m("picture",c)},[m,t.picture,n]),A=p.useCallback(()=>{m("picture",[]),h([])},[m]),T=async()=>{console.log("")},H=s.jsx(j,{xs:12,md:12,children:s.jsxs(L,{children:[s.jsx(q,{title:l("Details")}),s.jsxs(g,{spacing:3,sx:{p:3},children:[s.jsx(b,{name:"name",label:l("Graveyard_Name")}),s.jsx(b,{name:"location",label:l("Graveyard_Location")}),s.jsxs(g,{spacing:1.5,children:[s.jsx(F,{variant:"subtitle2",children:l("Content")}),s.jsx(le,{simple:!0,name:"content"})]}),s.jsxs(g,{spacing:1.5,children:[s.jsx(F,{variant:"subtitle2",children:l("Pictures")}),s.jsx(ie,{multiple:!0,thumbnail:!0,name:"picture",maxSize:13145728,onDrop:N,onRemove:_,onRemoveAll:A,onUpload:T})]})]})]})}),B=s.jsx(j,{xs:12,md:12,children:s.jsxs(L,{children:[s.jsx(q,{title:l("Properties")}),s.jsx(g,{spacing:3,sx:{p:3},children:s.jsxs(W,{columnGap:2,rowGap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",md:"repeat(1, 1fr)"},children:[s.jsx(b,{name:"newsLink",label:l("News")}),s.jsx(b,{name:"forecastLink",label:l("Forecast")})]})})]})}),I=s.jsx(j,{xs:12,md:12,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:s.jsx(Z,{type:"submit",variant:"contained",size:"large",loading:E,children:l(e?"save_changes":"create_product")})});return s.jsx(u,{methods:R,onSubmit:D,children:s.jsxs(j,{container:!0,spacing:3,children:[!!k&&s.jsx(P,{severity:"error",sx:{mb:3},children:k}),H,B,I]})})}export{xe as G};
