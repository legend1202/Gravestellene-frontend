import{al as V,j as e,am as H,eK as z,cj as U,Y as K,S as r,T as C,b7 as k,q as O,I as Y,g as $,m as Q,D as X,M as J,_ as Z,en as G,r as p,G as ee,a as ae,c as se,b as d,d as ie,o as te,s as D,e as b,a6 as de,N as re,h as le,F as oe,C as ne,K as ce}from"./index-N8SydwAL.js";import{E as me}from"./empty-content-Ttp3qqTd.js";import{b as xe}from"./graveyard-vLLPM793.js";import{c as he}from"./gravestone-WpFHd6L4.js";import{R as ue}from"./rhf-select-Y9ddv89c.js";import{D as pe}from"./DatePicker--X6roKNT.js";import{f as be}from"./index-sor8qiUr.js";import{S as q}from"./Skeleton-505Etpy4.js";function w({name:a,label:s,defaultValue:t}){const{control:i}=V();return e.jsx(H,{name:a,control:i,render:({field:c,fieldState:{error:o}})=>e.jsx(pe,{label:s,value:z(t),onChange:m=>{c.onChange(m)},slotProps:{textField:{fullWidth:!0,error:!!o,helperText:o==null?void 0:o.message}}})})}function ge({mail:a,selected:s,sx:t,...i}){if(a.approved)return e.jsxs(U,{sx:{p:1,mb:.5,borderRadius:1,...s&&{bgcolor:"action.selected"},...t},...i,children:[e.jsx(K,{primary:a.name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:"Graveyard Location",secondaryTypographyProps:{noWrap:!0,component:"span",variant:"body2",color:"text.secondary"}}),e.jsx(r,{alignItems:"flex-end",sx:{ml:2,height:44},children:e.jsx(C,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:a.cratedAt&&be(new Date(a.cratedAt),{addSuffix:!1})})})]})}function fe({sx:a,...s}){return e.jsxs(r,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,...a},...s,children:[e.jsx(q,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(r,{spacing:1,flexGrow:1,children:[e.jsx(q,{sx:{width:.75,height:10}}),e.jsx(q,{sx:{width:.5,height:10}})]})]})}function je({loading:a,mails:s,openMail:t,onCloseMail:i,onClickMail:c,selectedLabelId:o,selectedMailId:m}){const x=k("up","md"),h=e.jsx(e.Fragment,{children:[...Array(8)].map((l,u)=>e.jsx(fe,{},u))}),j=e.jsx(e.Fragment,{children:s&&s.map((l,u)=>e.jsx(ge,{mail:l,selected:m===l.id,onClick:()=>{c(l.id)}},u))}),g=e.jsxs(e.Fragment,{children:[e.jsx(r,{sx:{p:2},children:e.jsx(O,{placeholder:"Search...",InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx($,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsxs(Q,{sx:{px:2},children:[a&&h,s&&!!s.length&&j]})]});return x?e.jsx(r,{sx:{width:320,flexShrink:0,borderRadius:1.5,bgcolor:"background.default"},children:g}):e.jsx(X,{open:t,onClose:i,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:g})}const ye="inbox";function Fe({currentGravestone:a}){const{t:s}=J(),{enqueueSnackbar:t}=Z(),{graveyards:i,graveyardsLoading:c}=xe(),m=G().get("label")||ye,[x,h]=p.useState(""),j=k("up","md"),g=ee(),l=ae(),u=se().shape({name:d().required("name is required"),gender:d().required("gender is required"),birthday:d().required("birthday is required"),deceasedDate:d().required("deceasedDate is required"),buriedDate:d().required("buriedDate is required"),quarter:d().required("quarter is required"),graveSite:d().required("graveSite is required"),homeTown:d().required("homeTown is required"),graveSiteNumber:d().required("graveSiteNumber is required")}),_=p.useMemo(()=>({name:a?a.name:"",gender:a?a.gender:"",birthday:a?a.birthday:"",deceasedDate:a?a.deceasedDate:"",buriedDate:a?a.buriedDate:"",quarter:a?a.quarter:"",graveSite:a?a.graveSite:"",homeTown:a?a.homeTown:"",graveSiteNumber:a?a.graveSiteNumber:""}),[a]),I=ie({resolver:te(u),defaultValues:_}),{reset:F,watch:M,handleSubmit:P,formState:{isSubmitting:T}}=I,f=M(),L=p.useCallback(n=>{h(n)},[]);p.useEffect(()=>{i&&i.length>0&&i[0].id&&h(i[0].id)},[i]),p.useEffect(()=>{a&&h(a.graveyardId)},[a]);const N=P(async n=>{try{if(x){const y=D(f.birthday),E=D(f.buriedDate),W=D(f.deceasedDate),B={...f,birthday:y,buriedDate:E,deceasedDate:W,graveyardId:x},S=await he(B);S!=null&&S.searchResults.success,t(s(a?"update_success":"create_success")),F()}else t("Select the Graveyard!")}catch(y){console.error(y)}}),R=e.jsx(je,{mails:i,loading:c,openMail:l.value,onCloseMail:l.onFalse,onClickMail:L,selectedLabelId:m,selectedMailId:x}),v=e.jsx(e.Fragment,{children:i?e.jsxs(r,{spacing:3,sx:{p:1,flex:1,justifyContent:"space-between",overflowY:"scroll"},children:[e.jsx(b,{name:"name",label:s("Last_Name_and_First_Name")}),e.jsx(ue,{fullWidth:!0,name:"gender",label:s("Gender"),InputLabelProps:{shrink:!0},PaperPropsSx:{textTransform:"capitalize"},children:["MAN","WOMAN"].map(n=>e.jsx(de,{value:n,children:n},n))}),e.jsx(w,{name:"birthday",label:s("Birthday"),defaultValue:(a==null?void 0:a.birthday)||"05/10/2024"}),e.jsx(w,{name:"deceasedDate",label:s("deceased_date"),defaultValue:(a==null?void 0:a.deceasedDate)||"05/10/2024"}),e.jsx(w,{name:"buriedDate",label:s("buried_date"),defaultValue:(a==null?void 0:a.buriedDate)||"05/10/2024"}),e.jsx(b,{name:"quarter",label:s("Quarter")}),e.jsx(b,{name:"graveSite",label:s("grave_site")}),e.jsx(b,{name:"homeTown",label:s("Hometown")}),e.jsx(b,{name:"graveSiteNumber",label:s("gravesite_number")})]}):e.jsx(me,{imgUrl:"/assets/icons/empty/ic_email_disabled.svg",sx:{borderRadius:1.5,bgcolor:"background.default",...!j&&{display:"none"}}})}),A=e.jsx(re,{xs:12,md:12,sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",p:1},children:e.jsx(le,{type:"submit",variant:"contained",size:"large",loading:T,children:a?"Save Changes":s("create_product")})});return e.jsx(oe,{methods:I,onSubmit:N,children:e.jsxs(ne,{maxWidth:g.themeStretch?!1:"xl",children:[e.jsx(C,{variant:"h4",sx:{mb:{xs:3,md:5}},children:s("Gravestone")}),e.jsxs(r,{spacing:1,sx:{p:1,borderRadius:2,overflow:"hidden",position:"relative",bgcolor:"background.neutral"},children:[e.jsxs(r,{component:ce,direction:"row",sx:{height:"72vh"},children:[R,v]}),A]})]})})}export{Fe as G};
