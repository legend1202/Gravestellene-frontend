import{r as i,o as X,a4 as O,j as e,_ as F,s as oe,aB as se,t as re,i as le,bm as ne,bo as T,bn as ae,d as j,S as v,B,y as D,h as ie,z as ce,w as Y,b9 as de,d2 as ue,A as pe,L as he,d3 as xe,b as be,e as me,x as fe,aF as ge,p as R,C as Ce,R as je,d4 as we,H as ke}from"./index-_tg0Vjne.js";import"./index-R3sdzr18.js";import"./_baseToString-DU9o3e3j.js";import"./image-SDlH-Y9m.js";import"./color-picker-6ZFrZzyT.js";import"./index.esm-zORWVp2x.js";import"./styles-GXLlqNmt.js";import"./product-details-carousel-dZBA4jmL.js";import"./styles-xjWQ6_Y0.js";import{u as ve}from"./product-d2cPzUcv.js";import{E}from"./empty-content-y3p0Z0lQ.js";import{u as Z,c as ee,d as G,g as te,e as N,f as ye,h as Pe,i as Se,b as M,D as Te,G as Re,a as Ie,j as Le,C as Fe}from"./confirm-dialog-S7PJEDQN.js";import{C as De}from"./custom-breadcrumbs-KsOYWZLR.js";import{a as $,I as H,S as U,O as W}from"./TextField-ZkEZfJO9.js";import{C as q}from"./Checkbox-Ucah0XzZ.js";import{C as Q}from"./Chip-8y1KTROk.js";import{f as Ge}from"./format-number-x-XRdvJl.js";import{C as Oe}from"./Card-SUD4YaWI.js";import"./use-light-box-1YwnlQoR.js";import"./carousel-arrow-index-g72R1Kc2.js";import"./index-ntnlb33b.js";import"./Autocomplete-qcUxFr8Z.js";import"./Close-50MXt4l6.js";import"./Switch-wTiz88m9.js";import"./SwitchBase-73LMEt7P.js";import"./Skeleton-DE5mqhd_.js";import"./CircularProgress-JD4dZggQ.js";import"./FirstPage-W0D_CAXq.js";import"./TableCell-u3gO5J4l.js";import"./FormControlLabel-Tt1qENhS.js";import"./DialogTitle-ZVVh3H6m.js";import"./DialogContent-1g-PAecc.js";const Be=["onClick"],Ne=i.forwardRef(function(r,u){var x;const{onClick:c}=r,m=X(r,Be),b=O(),l=O(),s=Z(),a=ee(),p=G(s,te),g=n=>{p.open&&p.openedPanelValue===N.columns?s.current.hidePreferences():s.current.showPreferences(N.columns,l,b),c==null||c(n)};if(a.disableColumnSelector)return null;const f=p.open&&p.panelId===l;return e.jsx(a.slots.baseButton,F({ref:u,id:b,size:"small","aria-label":s.current.getLocaleText("toolbarColumnsLabel"),"aria-haspopup":"menu","aria-expanded":f,"aria-controls":f?l:void 0,startIcon:e.jsx(a.slots.columnSelectorIcon,{})},m,{onClick:g},(x=a.slotProps)==null?void 0:x.baseButton,{children:s.current.getLocaleText("toolbarColumns")}))}),Ve=["componentsProps"],_e=t=>{const{classes:r}=t;return re({root:["toolbarFilterList"]},ye,r)},Ae=oe("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(t,r)=>r.toolbarFilterList})(({theme:t})=>({margin:t.spacing(1,1,.5),padding:t.spacing(0,1)})),Me=i.forwardRef(function(r,u){var x,c;const{componentsProps:m={}}=r,b=X(r,Ve),l=m.button||{},s=Z(),a=ee(),p=G(s,Pe),g=G(s,Se),f=G(s,te),n=_e(a),h=O(),y=O(),I=i.useMemo(()=>{if(f.open)return s.current.getLocaleText("toolbarFiltersTooltipHide");if(p.length===0)return s.current.getLocaleText("toolbarFiltersTooltipShow");const P=d=>g[d.field].filterOperators.find(C=>C.value===d.operator).label||s.current.getLocaleText(`filterOperator${le(d.operator)}`).toString(),w=d=>{const{getValueAsString:C}=g[d.field].filterOperators.find(_=>_.value===d.operator);return C?C(d.value):d.value};return e.jsxs("div",{children:[s.current.getLocaleText("toolbarFiltersTooltipActive")(p.length),e.jsx(Ae,{className:n.root,ownerState:a,children:p.map((d,C)=>F({},g[d.field]&&e.jsx("li",{children:`${g[d.field].headerName||d.field}
                  ${P(d)}
                  ${d.value!=null?w(d):""}`},C)))})]})},[s,a,f.open,p,g,n]),V=P=>{var w;const{open:d,openedPanelValue:C}=f;d&&C===N.filters?s.current.hidePreferences():s.current.showPreferences(N.filters,y,h),(w=l.onClick)==null||w.call(l,P)};if(a.disableColumnFilter)return null;const L=f.open&&f.panelId===y;return e.jsx(a.slots.baseTooltip,F({title:I,enterDelay:1e3},b,(x=a.slotProps)==null?void 0:x.baseTooltip,{children:e.jsx(a.slots.baseButton,F({ref:u,id:h,size:"small","aria-label":s.current.getLocaleText("toolbarFiltersLabel"),"aria-controls":L?y:void 0,"aria-expanded":L,"aria-haspopup":!0,startIcon:e.jsx(se,{badgeContent:p.length,color:"primary",children:e.jsx(a.slots.openFilterButtonIcon,{})})},l,{onClick:V},(c=a.slotProps)==null?void 0:c.baseButton,{children:s.current.getLocaleText("toolbarFilters")}))}))});function ze({filters:t,onFilters:r,stockOptions:u,publishOptions:x}){const c=ne(),[m,b]=i.useState(t.stock),[l,s]=i.useState(t.publish),a=i.useCallback(n=>{const{target:{value:h}}=n;b(typeof h=="string"?h.split(","):h)},[]),p=i.useCallback(n=>{const{target:{value:h}}=n;s(typeof h=="string"?h.split(","):h)},[]),g=i.useCallback(()=>{r("stock",m)},[r,m]),f=i.useCallback(()=>{r("publish",l)},[r,l]);return e.jsxs(e.Fragment,{children:[e.jsxs($,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(H,{children:"Stock"}),e.jsx(U,{multiple:!0,value:m,onChange:a,input:e.jsx(W,{label:"Stock"}),renderValue:n=>n.map(h=>h).join(", "),onClose:g,sx:{textTransform:"capitalize"},children:u.map(n=>e.jsxs(T,{value:n.value,children:[e.jsx(q,{disableRipple:!0,size:"small",checked:m.includes(n.value)}),n.label]},n.value))})]}),e.jsxs($,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(H,{children:"Publish"}),e.jsx(U,{multiple:!0,value:l,onChange:p,input:e.jsx(W,{label:"Publish"}),renderValue:n=>n.map(h=>h).join(", "),onClose:f,sx:{textTransform:"capitalize"},children:x.map(n=>e.jsxs(T,{value:n.value,children:[e.jsx(q,{disableRipple:!0,size:"small",checked:l.includes(n.value)}),n.label]},n.value))})]}),e.jsxs(ae,{open:c.open,onClose:c.onClose,arrow:"right-top",sx:{width:140},children:[e.jsxs(T,{onClick:()=>{c.onClose()},children:[e.jsx(j,{icon:"solar:printer-minimalistic-bold"}),"Print"]}),e.jsxs(T,{onClick:()=>{c.onClose()},children:[e.jsx(j,{icon:"solar:import-bold"}),"Import"]}),e.jsxs(T,{onClick:()=>{c.onClose()},children:[e.jsx(j,{icon:"solar:export-bold"}),"Export"]})]})]})}function Ee({filters:t,onFilters:r,onResetFilters:u,results:x,...c}){const m=i.useCallback(l=>{const s=t.stock.filter(a=>a!==l);r("stock",s)},[t.stock,r]),b=i.useCallback(l=>{const s=t.publish.filter(a=>a!==l);r("publish",s)},[t.publish,r]);return e.jsxs(v,{spacing:1.5,...c,children:[e.jsxs(B,{sx:{typography:"body2"},children:[e.jsx("strong",{children:x}),e.jsx(B,{component:"span",sx:{color:"text.secondary",ml:.25},children:"results found"})]}),e.jsxs(v,{flexGrow:1,spacing:1,direction:"row",flexWrap:"wrap",alignItems:"center",children:[!!t.stock.length&&e.jsx(K,{label:"Stock:",children:t.stock.map(l=>e.jsx(Q,{label:l,size:"small",onDelete:()=>m(l)},l))}),!!t.publish.length&&e.jsx(K,{label:"Publish:",children:t.publish.map(l=>e.jsx(Q,{label:l,size:"small",onDelete:()=>b(l)},l))}),e.jsx(D,{color:"error",onClick:u,startIcon:e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})]})}function K({label:t,children:r,sx:u,...x}){return e.jsxs(v,{component:ie,variant:"outlined",spacing:1,direction:"row",sx:{p:1,borderRadius:1,overflow:"hidden",borderStyle:"dashed",...u},...x,children:[e.jsx(B,{component:"span",sx:{typography:"subtitle2"},children:t}),e.jsx(v,{spacing:1,direction:"row",flexWrap:"wrap",children:r})]})}function k({params:t}){return e.jsx(e.Fragment,{children:Ge(t.row.price)})}function $e({params:t}){return e.jsx(ce,{variant:"soft",color:t.row.publish==="published"&&"info"||"default",children:t.row.publish})}function He({params:t}){return e.jsx(Y,{primary:de(t.row.createdAt),secondary:ue(t.row.createdAt),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}function Ue({params:t}){return e.jsxs(v,{direction:"row",alignItems:"center",sx:{py:2,width:1},children:[e.jsx(pe,{alt:t.row.name,src:t.row.coverUrl,variant:"rounded",sx:{width:64,height:64,mr:2}}),e.jsx(Y,{disableTypography:!0,primary:e.jsx(he,{noWrap:!0,color:"inherit",variant:"subtitle2",onClick:t.row.onViewRow,sx:{cursor:"pointer"},children:t.row.name}),secondary:e.jsx(B,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:t.row.category}),sx:{display:"flex",flexDirection:"column"}})]})}const J=[{value:"published",label:"Published"},{value:"draft",label:"Draft"}],z={publish:[],stock:[]},We={category:!1},qe=["category","actions"];function Qe(){const{enqueueSnackbar:t}=xe(),r=be(),u=me(),x=fe(),{products:c,productsLoading:m}=ve(),[b,l]=i.useState([]),[s,a]=i.useState(z),[p,g]=i.useState([]),[f,n]=i.useState(We);i.useEffect(()=>{c.length&&l(c)},[c]);const h=Ke({inputData:b,filters:s}),y=!ge(z,s),I=i.useCallback((o,S)=>{a(A=>({...A,[o]:S}))},[]),V=i.useCallback(()=>{a(z)},[]),L=i.useCallback(o=>{const S=b.filter(A=>A.id!==o);t("Delete success!"),l(S)},[t,b]),P=i.useCallback(()=>{const o=b.filter(S=>!p.includes(S.id));t("Delete success!"),l(o)},[t,p,b]),w=i.useCallback(o=>{u.push(R.dashboard.product.edit(o))},[u]),d=i.useCallback(o=>{u.push(R.dashboard.product.details(o))},[u]),C=[{field:"category",headerName:"Category",filterable:!1},{field:"name",headerName:"Gravestone",flex:1,minWidth:160,hideable:!1,renderCell:o=>e.jsx(Ue,{params:o})},{field:"gender",headerName:"gender",width:140,editable:!0,renderCell:o=>e.jsx(k,{params:o})},{field:"birthday",headerName:"Birthday",width:140,editable:!0,renderCell:o=>e.jsx(k,{params:o})},{field:"deceasedDate",headerName:"Deceased Date",width:140,editable:!0,renderCell:o=>e.jsx(k,{params:o})},{field:"buriedDate",headerName:"Buried Date",width:140,editable:!0,renderCell:o=>e.jsx(k,{params:o})},{field:"quarter",headerName:"Quarter",width:140,editable:!0,renderCell:o=>e.jsx(k,{params:o})},{field:"graveSite",headerName:"Grave Site",width:140,editable:!0,renderCell:o=>e.jsx(k,{params:o})},{field:"publish",headerName:"Publish",width:110,type:"singleSelect",editable:!0,valueOptions:J,renderCell:o=>e.jsx($e,{params:o})},{field:"createdAt",headerName:"Create at",width:160,renderCell:o=>e.jsx(He,{params:o})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:o=>[e.jsx(M,{showInMenu:!0,icon:e.jsx(j,{icon:"solar:eye-bold"}),label:"View",onClick:()=>d(o.row.id)}),e.jsx(M,{showInMenu:!0,icon:e.jsx(j,{icon:"solar:pen-bold"}),label:"Edit",onClick:()=>w(o.row.id)}),e.jsx(M,{showInMenu:!0,icon:e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),label:"Delete",onClick:()=>{L(o.row.id)},sx:{color:"error.main"}})]}],_=()=>C.filter(o=>!qe.includes(o.field)).map(o=>o.field);return e.jsxs(e.Fragment,{children:[e.jsxs(Ce,{maxWidth:x.themeStretch?!1:"lg",sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(De,{heading:"List",links:[{name:"Dashboard",href:R.dashboard.root},{name:"Gravestone",href:R.fellesraad.gravestone.root},{name:"List"}],action:e.jsx(D,{component:je,href:R.fellesraad.gravestone.create,variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),children:"New Gravestone"}),sx:{mb:{xs:3,md:5}}}),e.jsx(Oe,{sx:{height:{xs:800,md:2},flexGrow:{md:1},display:{md:"flex"},flexDirection:{md:"column"}},children:e.jsx(Te,{checkboxSelection:!0,disableRowSelectionOnClick:!0,rows:h,columns:C,loading:m,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:10}}},onRowSelectionModelChange:o=>{g(o)},columnVisibilityModel:f,onColumnVisibilityModelChange:o=>n(o),slots:{toolbar:()=>e.jsxs(e.Fragment,{children:[e.jsxs(Re,{children:[e.jsx(ze,{filters:s,onFilters:I,stockOptions:we,publishOptions:J}),e.jsx(Ie,{}),e.jsxs(v,{spacing:1,flexGrow:1,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!!p.length&&e.jsxs(D,{size:"small",color:"error",startIcon:e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),onClick:r.onTrue,children:["Delete (",p.length,")"]}),e.jsx(Ne,{}),e.jsx(Me,{}),e.jsx(Le,{})]})]}),y&&e.jsx(Ee,{filters:s,onFilters:I,onResetFilters:V,results:h.length,sx:{p:2.5,pt:0}})]}),noRowsOverlay:()=>e.jsx(E,{title:"No Data"}),noResultsOverlay:()=>e.jsx(E,{title:"No results found"})},slotProps:{columnsPanel:{getTogglableColumns:_}}})})]}),e.jsx(Fe,{open:r.value,onClose:r.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete"," ",e.jsxs("strong",{children:[" ",p.length," "]})," items?"]}),action:e.jsx(D,{variant:"contained",color:"error",onClick:()=>{P(),r.onFalse()},children:"Delete"})})]})}function Ke({inputData:t,filters:r}){const{stock:u,publish:x}=r;return u.length&&(t=t.filter(c=>u.includes(c.inventoryType))),x.length&&(t=t.filter(c=>x.includes(c.publish))),t}function Rt(){return e.jsxs(e.Fragment,{children:[e.jsx(ke,{children:e.jsx("title",{children:" Dashboard: Gravestone List"})}),e.jsx(Qe,{})]})}export{Rt as default};
